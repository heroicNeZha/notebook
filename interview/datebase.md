# 数据库

1. MySQL的MylSAM和Innodb的区别（从事务，锁，B+树索引，读写性能方面分析)
2. Innodb的B+树索引和MylSAM的B+树索引的结构区别
3. 为什么索引能够提高性能（可以从B+树结构方面分析）
4. B树和B+树的区别,为什么MySQL要使用B+树(磁盘和树高方面)
5. count(*)和count(1)的区别
6. MySQL的主备模式

## 优化

#### 为什么要优化
系统的吞吐量瓶颈往往出现在数据库的访问速度上
随着应用程序的运行，数据库的中的数据会越来越多，处理时间会相应变慢
数据是存放在磁盘上的，读写速度无法和内存相比
#### 如何优化
设计数据库时：数据库表、字段的设计，存储引擎
利用好MySQL自身提供的功能，如索引等
横向扩展：MySQL集群、负载均衡、读写分离
SQL语句的优化（收效甚微）

### 字段设计

1. 原则：尽量使用整型表示字符串 INET_ATON(str)/INET_NTOA(number)
2. 原则：定长和非定长数据类型的选择 decimal,varchar,text
3. 原则：尽可能选择小的数据类型和指定短的长度
4. 原则：尽可能使用 not null
5. 原则：字段注释要完整，见名知意
6. 原则：单表字段不宜过多
7. 原则：可以预留字段

### 关联表的设计

1. 一对多:使用外键
2. 多对多:单独新建一张表将多对多拆分成两个一对多
3. 一对一:如商品的基本信息（item）和商品的详细信息（item_intro），通常使用相同的主键或者增加一个外键字段（item_id）

### 范式

第一范式1NF：字段原子性
第二范式：消除对主键的部分依赖
第三范式：消除对主键的传递依赖

### 存储引擎的选择

|                                                                 |                     MyISAM                      | Innodb                                   |
| :-------------------------------------------------------------: | :---------------------------------------------: |
|                            文件格式                             |   数据和索引是分别存储的，数据.MYD，索引.MYI    | 数据和索引是集中存储的，.ibd             |
|                          文件能否移动                           |      能，一张表就对应.frm、MYD、MYI3个文件      | 否，因为关联的还有data下的其它文件       |
|                          记录存储顺序                           |               按记录插入顺序保存                | 按主键大小有序插入                       |
|   空间碎片（删除记录并flush table 表名之后，表文件大小不变）    | 产生。定时整理：使用命令optimize table 表名实现 | 不产生                                   |
|                              事务                               |                     不支持                      | 支持                                     |
|                              外键                               |                     不支持                      | 支持                                     |
| 锁支持（锁是避免资源争用的一个机制，MySQL锁对用户几乎是透明的） |                    表级锁定                     | 行级锁定、表级锁定，锁定力度小并发能力高 |